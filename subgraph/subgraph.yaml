specVersion: 0.0.5
schema:
  file: ./schema.graphql
dataSources:
  # GovernanceCore
  - kind: ethereum/contract
    name: GovernanceCore
    network: sepolia
    source:
      address: "0xd9145CCE52D386f254917e481eB44e9943F39138"
      abi: GovernanceCore
      startBlock: 5234567
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - GovernanceParameter
        - ParameterChange
        - AuditRecord
      abis:
        - name: GovernanceCore
          file: ./abis/GovernanceCore.json
      eventHandlers:
        - event: ProposalCreated(indexed uint256,indexed address,string)
          handler: handleProposalCreated
        - event: ParameterUpdated(string,uint256,uint256)
          handler: handleParameterUpdated
        - event: ModuleRegistered(indexed address,string)
          handler: handleModuleRegistered
        - event: EmergencyPaused(indexed address,uint256)
          handler: handleEmergencyPaused
        - event: RoleGranted(indexed bytes32,indexed address,indexed address)
          handler: handleRoleGranted
        - event: RoleRevoked(indexed bytes32,indexed address,indexed address)
          handler: handleRoleRevoked
      file: ./src/governance-core.ts

  # ProposalManager
  - kind: ethereum/contract
    name: ProposalManager
    network: sepolia
    source:
      address: "0xd8b934580fcE35a11B58C6D73aDeE468a2833fa8"
      abi: ProposalManager
      startBlock: 5234568
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Proposal
        - DailyStats
        - MonthlyStats
      abis:
        - name: ProposalManager
          file: ./abis/ProposalManager.json
      eventHandlers:
        - event: ProposalCreated(indexed uint256,indexed address)
          handler: handleProposalCreatedManager
        - event: VoteCast(indexed address,indexed uint256,uint8,uint256)
          handler: handleVoteCastManager
        - event: ProposalStatusChanged(indexed uint256,uint8,uint8)
          handler: handleProposalStatusChanged
        - event: ProposalCanceled(indexed uint256,indexed address)
          handler: handleProposalCanceled
      file: ./src/proposal-manager.ts

  # VotingEngine
  - kind: ethereum/contract
    name: VotingEngine
    network: sepolia
    source:
      address: "0xd2a5bC10698FD955D1Fe6cb468a17809A08fd005"
      abi: VotingEngine
      startBlock: 5234569
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Vote
        - Proposal
        - Citizen
        - DailyStats
      abis:
        - name: VotingEngine
          file: ./abis/VotingEngine.json
      eventHandlers:
        - event: VoteCast(indexed address,indexed uint256,uint8,uint256,string)
          handler: handleVoteCast
        - event: VotingStrategyChanged(indexed uint256,uint8)
          handler: handleVotingStrategyChanged
        - event: DelegateChanged(indexed address,indexed address,indexed address)
          handler: handleDelegateChanged
      file: ./src/voting-engine.ts

  # TreasuryManager
  - kind: ethereum/contract
    name: TreasuryManager
    network: sepolia
    source:
      address: "0x9D7f74d0C41E726EC95884E0e97Fa6129e3b5E99"
      abi: TreasuryManager
      startBlock: 5234570
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - TreasuryTransaction
        - Budget
        - DailyStats
      abis:
        - name: TreasuryManager
          file: ./abis/TreasuryManager.json
      eventHandlers:
        - event: Deposit(indexed address,indexed address,uint256,uint256)
          handler: handleDeposit
        - event: Withdrawal(indexed address,indexed address,uint256,uint256)
          handler: handleWithdrawal
        - event: BudgetCreated(indexed uint256,string,uint256)
          handler: handleBudgetCreated
        - event: BudgetApproved(indexed uint256,indexed address)
          handler: handleBudgetApproved
        - event: SpendingLimitUpdated(indexed address,uint256)
          handler: handleSpendingLimitUpdated
      file: ./src/treasury-manager.ts

  # CitizenRegistry
  - kind: ethereum/contract
    name: CitizenRegistry
    network: sepolia
    source:
      address: "0x7EF2e0048f5bAeDe046f6BF797943daF4ED8CB47"
      abi: CitizenRegistry
      startBlock: 5234571
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Citizen
        - DailyStats
        - MonthlyStats
      abis:
        - name: CitizenRegistry
          file: ./abis/CitizenRegistry.json
      eventHandlers:
        - event: CitizenRegistered(indexed address,uint256,uint256)
          handler: handleCitizenRegistered
        - event: CitizenshipApproved(indexed address,indexed address,uint256)
          handler: handleCitizenshipApproved
        - event: CitizenshipRevoked(indexed address,indexed address,uint256)
          handler: handleCitizenshipRevoked
        - event: VotingPowerDelegated(indexed address,indexed address,uint256)
          handler: handleVotingPowerDelegated
        - event: DelegationRevoked(indexed address,indexed address)
          handler: handleDelegationRevoked
      file: ./src/citizen-registry.ts

  # DIDRegistry
  - kind: ethereum/contract
    name: DIDRegistry
    network: sepolia
    source:
      address: "0xDA0bab807633f07f013f94DD0E6A4F96F8742B53"
      abi: DIDRegistry
      startBlock: 5234572
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Citizen
      abis:
        - name: DIDRegistry
          file: ./abis/DIDRegistry.json
      eventHandlers:
        - event: IdentityRegistered(indexed address,indexed bytes32,string,uint256)
          handler: handleIdentityRegistered
        - event: IdentityVerified(indexed address,indexed address,uint256)
          handler: handleIdentityVerified
        - event: IdentityRevoked(indexed address,indexed address,uint256)
          handler: handleIdentityRevoked
      file: ./src/did-registry.ts

  # ComplianceEngine
  - kind: ethereum/contract
    name: ComplianceEngine
    network: sepolia
    source:
      address: "0x358AA13c52544ECCEF6B0ADD0f801012ADAD5eE3"
      abi: ComplianceEngine
      startBlock: 5234573
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - ComplianceRule
        - ComplianceViolation
        - AuditRecord
      abis:
        - name: ComplianceEngine
          file: ./abis/ComplianceEngine.json
      eventHandlers:
        - event: RuleCreated(indexed uint256,uint8,string)
          handler: handleRuleCreated
        - event: ViolationReported(indexed uint256,indexed address,indexed uint256)
          handler: handleViolationReported
        - event: ViolationResolved(indexed uint256,indexed address)
          handler: handleViolationResolved
        - event: AuditRecordCreated(indexed uint256,indexed address,string)
          handler: handleAuditRecordCreated
      file: ./src/compliance-engine.ts

  # LegalDocumentRegistry
  - kind: ethereum/contract
    name: LegalDocumentRegistry
    network: sepolia
    source:
      address: "0xddaAd340b0f1Ef65169Ae5E41A8b10776a75482d"
      abi: LegalDocumentRegistry
      startBlock: 5234574
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - LegalDocument
      abis:
        - name: LegalDocumentRegistry
          file: ./abis/LegalDocumentRegistry.json
      eventHandlers:
        - event: DocumentCreated(indexed uint256,uint8,string,indexed address)
          handler: handleDocumentCreated
        - event: DocumentApproved(indexed uint256,indexed address,uint256)
          handler: handleDocumentApproved
        - event: DocumentActivated(indexed uint256,uint256)
          handler: handleDocumentActivated
        - event: ConstitutionUpdated(indexed uint256,indexed uint256)
          handler: handleConstitutionUpdated
      file: ./src/legal-document-registry.ts
